(function(){var e={1035:function(e,t,a){"use strict";var n=a(77162),o=a(48046),r=a(29197),s=a(98473);function i(e,t,a,n,o,r){const i=(0,s.up)("router-view"),c=(0,s.up)("main-layout");return(0,s.wg)(),(0,s.j4)(c,{pagetitle:n.title},{default:(0,s.w5)((()=>[(0,s.Wm)(i)])),_:1},8,["pagetitle"])}var c=a(64188);function l(e,t,a,n,o,r){const i=(0,s.up)("robo-layout-header");return o.renderComponent?((0,s.wg)(),(0,s.j4)(i,{key:0,logoIcon:"images/icon_white.svg",navigation:o.navigation,title:a.title,version:o.version},null,8,["navigation","title","version"])):(0,s.kq)("",!0)}a(46229),a(17330),a(62062);var u=a(55984),d=a.n(u);function p(e){return new(d())(e.toString())}function m(e,t){return p(e).todp(t)}function h(e,t=0,a){return p(e).div(new(d())(10).pow(t.toString())).todp(a).toString()}function w(){console.log("Build version:",{NODE_ENV:"production",VUE_APP_ROBONOMICS_UI_KEY:"88tHsnwjp*p36AurOu28W6UZz",BASE_URL:""}.VUE_APP_GIT_BRANCH,{NODE_ENV:"production",VUE_APP_ROBONOMICS_UI_KEY:"88tHsnwjp*p36AurOu28W6UZz",BASE_URL:""}.VUE_APP_GIT_TAG,{NODE_ENV:"production",VUE_APP_ROBONOMICS_UI_KEY:"88tHsnwjp*p36AurOu28W6UZz",BASE_URL:""}.VUE_APP_GIT_SHA)}d().set({toExpNeg:-31,toExpPos:31});var f=a(65633),v={props:{title:{type:String,default:"Robonomics Dapp"}},inject:["RobonomicsProvider","EthereumProvider"],data(){return{renderComponent:!0,navigation:[{title:"Services",links:[{title:"Sensors map",link:"https://sensors.robonomics.network",type:"external"}]},{title:"Tokenomics",links:[{title:"About XRT",link:"https://robonomics.network/xrt/",type:"external"},{title:"Uniswap",link:"https://app.uniswap.org/#/swap?inputCurrency=0x7de91b204c1c737bcee6f000aaa6569cf7061cb7&outputCurrency=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",type:"external"},{title:"Basilisk",link:"https://app.basilisk.cloud/pools-and-farms",type:"external"}]},{title:"Tools",links:[{title:"Substrate Portal",link:"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/explorer",type:"external"},{title:"Subscan",link:"https://robonomics.subscan.io/",type:"external"},{title:"Polkassembly",link:"https://robonomics.polkassembly.io/",type:"external"}]},{title:"Robonomics Parachain",links:[{title:"Polkadot",link:"/?rpc=wss%3A%2F%2Fpolkadot.rpc.robonomics.network%2F"},{title:"Kusama",link:"/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F"}]}],version:" "}},computed:{robonomics:function(){return(0,c.IU)(this.RobonomicsProvider.instance.value)}},watch:{"$store.state.robonomicsUIvue.polkadot.extensionObj":function(e){e.signer&&e.signer.signRaw&&this.$store.state.robonomicsUIvue.polkadot.address&&this.handlerAccount(this.$store.state.robonomicsUIvue.polkadot.address)},"$store.state.robonomicsUIvue.polkadot.address":{handler:function(e){e&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer.signRaw&&this.handlerAccount(e)},immediate:!0},"RobonomicsProvider.isReady.value":{handler:function(e,t){e&&!t&&this.handlerAccount(this.$store.state.robonomicsUIvue.polkadot.address)},immediate:!0},$route:async function(){this.renderComponent=!1,await this.$nextTick(),this.renderComponent=!0}},async created(){try{const e=await f.Z.get("https://api.github.com/repos/airalab/dapp.robonomics.network/releases/latest");e.data.tag_name&&(this.version=e.data.tag_name)}catch(e){console.log("dApp version not found.")}},methods:{setCurrentNetwork(){let e="kusama";const t=localStorage.getItem("rpc-parachain");t&&(e=URL.parse(t).host.split(".")[0]),"polkadot"===e?this.navigation[3].links[0]={title:"›Polkadot"}:this.navigation[3].links[1]={title:"›Kusama"}},async handlerAccount(e){if(!this.RobonomicsProvider.isReady.value)return;if(this.unsubscribeBalance&&this.unsubscribeBalance(),this.setCurrentNetwork(),!this.$store.state.robonomicsUIvue.polkadot.accounts)return;const t=this.$store.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e));t&&("telemetry"!==this.$route.name&&await this.robonomics.accountManager.setSender(e,{type:t.type,extension:this.$store.state.robonomicsUIvue.polkadot.extensionObj}),this.unsubscribeBalance=await this.robonomics.account.getBalance(e,(e=>{const t=e.free.sub(e.frozen);this.$store.commit("polkadot/setBalanceXRT",m(h(t,this.robonomics.api.registry.chainDecimals[0]),4))})))}}},g=a(25312);const y=(0,g.Z)(v,[["render",l]]);var b=y,k=a(24887);const _=["data-label"];var S={__name:"Footer",setup(e){const t=[{title:"Services",links:[{title:"Sensors map",link:"https://sensors.robonomics.network"}]},{title:"Tokenomics",links:[{title:"About XRT",link:"https://robonomics.network/xrt/"},{title:"Uniswap",link:"https://app.uniswap.org/#/swap?inputCurrency=0x7de91b204c1c737bcee6f000aaa6569cf7061cb7&outputCurrency=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"},{title:"Basilisk",link:"https://app.basilisk.cloud/pools-and-farms"}]},{title:"Tools",links:[{title:"Substrate Portal",link:"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/explorer"},{title:"Subscan",link:"https://robonomics.subscan.io/"},{title:"Polkassembly",link:"https://robonomics.polkassembly.io/"}]},{title:"Help",links:[{title:"Wiki",link:"https://wiki.robonomics.network/"},{title:"Academy",link:"https://robonomics.academy/"},{title:"Contacts",link:"https://robonomics.network/contact/"}]}];return(e,a)=>{const n=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("footer",null,[(0,s._)("nav",null,[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(t,(e=>(0,s._)("ul",{key:e.title,"data-label":e.title},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.links,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.title},[(0,s.Wm)(n,{to:e.link,exact:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,k.zw)(e.title),1)])),_:2},1032,["to"])])))),128))],8,_))),64))])])}}};const U=(0,g.Z)(S,[["__scopeId","data-v-348a5c2f"]]);var I=U,A={default_rpc_endpoint:"wss://polkadot.rpc.robonomics.network/",nft_oracle_endpoint:"https://nft-oracle.robonomics.network/"};var R=a(44406),P=a(76833),W=a(37695);function x(){const e=(0,s.f3)("RobonomicsProvider");return{accountManager:e.accountManager,isReady:e.isReady,robonomics:e.instance,getInstance:()=>e.instance.value}}const C=(e=null)=>{const{isReady:t,getInstance:a}=x(),n=(0,c.iH)(e),o=(0,c.iH)([]),r=async e=>{const n=localStorage.getItem("rpc-parachain")||A.default_rpc_endpoint,o=`hadevices:${n}:${e}`;if(t.value)try{const t=await a().rws.getDevices(e),n=t.map((e=>e.toHuman()));return localStorage.setItem(o,JSON.stringify({time:Date.now(),value:n})),console.log("getDevices chain"),{data:n,cache:!1}}catch(r){console.log(r)}else{const e=localStorage.getItem(o);if(!e)return{data:[],cache:!0};try{const t=JSON.parse(e);return console.log("getDevices cache"),{data:t.value,cache:!0}}catch(r){console.log("hadevices bad",r)}}return{data:[],cache:!1}},i=async()=>{if(n.value)try{(0,W.Y)(n.value);const e=await r(n.value);if(o.value=e.data,e.cache){const e=(0,s.YP)(t,(async()=>{if(t.value){const t=await r(n.value);o.value=t.data,e()}}),{immediate:!0})}return}catch(e){console.log(e)}o.value=[]};return(0,s.YP)(n,(async()=>{await i()}),{immediate:!0}),(0,s.YP)(t,(async e=>{if(e){const e=await a().events.on({section:"rws",method:"NewDevices"},(async e=>{for(const t of e)t.data[0].toHuman()===n.value&&await i()}));(0,s.Ah)(e)}}),{immediate:!0}),{owner:n,devices:o,loadDevices:i}},O=()=>{const e=new R.P,t={PalletRobonomicsRwsSubscription:{_enum:{Lifetime:{tps:"Compact<u32>"},Daily:{days:"Compact<u32>"}}},PalletRobonomicsRwsSubscriptionLedger:{freeWeight:"Compact<u64>",issueTime:"Compact<u64>",lastUpdate:"Compact<u64>",kind:{_enum:{Lifetime:{tps:"Compact<u32>"},Daily:{days:"Compact<u32>"}}}}};return e.register(t),e},N=(e=null)=>{const t=(0,c.iH)(e),a=(0,c.XI)(null),{isReady:n,getInstance:o}=x(),{devices:r,loadDevices:i}=C(t),l=()=>o().api.consts.rws.referenceCallWeight,u=async e=>{const t=localStorage.getItem("rpc-parachain")||A.default_rpc_endpoint,a=`hasubscription:${t}:${e}`;if(n.value){const t=await o().rws.getLedger(e);if(!t.isEmpty)return localStorage.setItem(a,JSON.stringify({time:Date.now(),value:t.value.toJSON()})),console.log("getLedger chain"),{data:t.value,cache:!1}}else{const e=localStorage.getItem(a);if(!e)return{data:void 0,cache:!0};try{const t=JSON.parse(e),a=(0,P.Z)(O(),"Option<PalletRobonomicsRwsSubscriptionLedger>",t.value);return console.log("getLedger cache"),{data:a.value,cache:!0}}catch(r){console.log("hasubscription bad",r)}}return{data:void 0,cache:!1}},d=864e5,p=async e=>{const t=(await u(e)).data;if(!t)return-1;const a=t.freeWeight.toNumber(),n=t.lastUpdate.toNumber(),o=t.issueTime.toNumber(),r=l(),s=Date.now();let i=(()=>{let e;if(t.kind.isLifetime)e=t.kind.value.tps.toNumber();else{const a=t.kind.value.days.toNumber(),n=a*d;e=s<o+n?1e4:0}return e})();const c=s-n;return Math.floor(a+r*i*c/1e9)},m=(0,s.Fl)((()=>{if(!a.value)return null;if(a.value.kind.isLifetime)return null;const e=a.value.issueTime.toNumber();let t=0;return a.value.kind.isDaily&&(t=a.value.kind.value.days.toNumber()),e+t*d})),h=(0,s.Fl)((()=>{if(!a.value)return 0;let e=0;return a.value.kind.isDaily&&(e=a.value.kind.value.days.toNumber()),e/30})),w=(0,s.Fl)((()=>!(!a.value||null!==m.value&&Date.now()>m.value))),f=(0,s.Fl)((()=>a.value)),v=async()=>{if(t.value)try{(0,W.Y)(t.value);const e=await u(t.value);if(a.value=e.data,e.cache){const e=(0,s.YP)(n,(async()=>{if(n.value){const n=await u(t.value);a.value=n.data,e()}}),{immediate:!0})}return}catch(e){console.log(e)}a.value=null};return(0,s.YP)(t,(async()=>{await v()}),{immediate:!0}),{owner:t,dataRaw:a,hasSubscription:f,isActive:w,countMonth:h,validUntil:m,loadLedger:v,devices:r,loadDevices:i,getFreeWeightCalc:p}};var E=a(90299),T={__name:"Main",props:{pagetitle:{type:String}},setup(e){const t=e,a=(0,E.oR)(),n=N();return(0,s.YP)((()=>a.state.robonomicsUIvue.rws.active),(e=>{n.owner.value=e}),{immediate:!0}),(0,s.YP)([n.owner,n.validUntil],(()=>{a.commit("rws/setExpiredate",n.validUntil)}),{immediate:!0}),(0,s.YP)(n.devices,(e=>{a.commit("rws/setUsers",e)}),{immediate:!0}),(e,a)=>{const n=(0,s.up)("robo-layout");return(0,s.wg)(),(0,s.j4)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)((0,c.SU)(b),{title:t.pagetitle},null,8,["title"]),(0,s.WI)(e.$slots,"default"),(0,s.Wm)((0,c.SU)(I))])),_:3})}}};const D=T;var M=D,H=a(94731),j={name:"App",components:{MainLayout:M},setup(){const e=(0,s.f3)("RobonomicsProvider"),t=(0,s.f3)("IpfsProvider"),a=(0,E.oR)(),n=(0,H.tv)(),o=(0,H.yj)(),r=(0,c.iH)();return a.commit("rws/setKey","88tHsnwjp*p36AurOu28W6UZz"),a.dispatch("rws/init"),a.commit("rws/setLinkActivate",n.resolve({name:"rwsActivate"}).path),a.commit("rws/setLinkSetup",n.resolve({name:"rwsSetup"}).path),a.commit("rws/setLinkSetupnew",n.resolve({name:"rwsSetupNew"}).path),a.commit("rws/setLinkDevices",n.resolve({name:"telemetry"}).path),a.commit("ipfs/setGateways",t.gateways),(0,s.YP)(o,(()=>{r.value=o?.meta?.title;const e=r.value?`${r.value} / Robonomics Dapp`:"Robonomics Dapp";document.title=e,document.querySelector('meta[property="og:title"]').setAttribute("content",e)})),(0,s.YP)([o,e.isReady],(([e,t])=>{"telemetry"!==e.name&&t&&(a.dispatch("app/setlibp2p",{connected:!1}),a.dispatch("app/setrelay",{connected:!1}))}),{immediate:!0}),{title:r}}};const $=(0,g.Z)(j,[["render",i]]);var Y=$,B=(a(57658),a(66665));class F{constructor(e){this.endpoint=e,this.authHeader=null,this.robonomics=null,this._create()}_create(){this.client=(0,B.Ue)({...this._options()})}_options(){return{url:this.endpoint,headers:{authorization:`Basic ${this.authHeader}`,robonomics:this.robonomics}}}isAuth(){return!!this.authHeader&&!!this.robonomics}auth(e,t,a){const n=`sub-${t}:${a}`;this.authHeader=Buffer.from(n).toString("base64"),this.robonomics=e,this._create()}authClear(){this.authHeader=null,this.robonomics=null,this._create()}async ls(e){const t=[];for await(const a of this.client.ls(e))"file"===a.type&&t.push(a);return t}async cat(e){const t=async e=>{const t=new TextDecoder;let a="";for await(const n of this.client.cat(e))a+=t.decode(n,{stream:!0});return a};return await t(e)}async add(e){return await this.client.add(e)}async catViaGateway(e,t,a=5){for(let o=1;o<=a;o++)try{return(await f.Z.get(`${e}${t}`)).data}catch(n){console.log(n)}throw new Error("File not available")}async catViaGatewaysRotation(e,t){for(const n of e)try{return{gateway:n,result:await this.catViaGateway(n,t)}}catch(a){console.log(a.message)}throw new Error("File not available")}async catViaGateways(e,t){const a=new AbortController,n=async(e,t)=>{const n=await f.Z.get(`${e}${t}`,{signal:a.signal});return a.abort(),n.data},o=[];for(const s of e)o.push(n(s,t));try{const t=await Promise.any(o.map(((e,t)=>e.then((e=>[e,t])))));return{gateway:e[t[1]],result:t[0]}}catch(r){throw new Error("File not available")}}}var z={install:(e,t)=>{const a=(0,c.iH)();e.provide("IpfsProvider",{instance:a,gateways:t.gateways||[]}),a.value=new F(t.api.gateway)}},L=a(11477),K=a(22971),Z=a(63310),q=a(83830),V=a(4598),G=a(95241),J=a(76220),X=a(64560),Q=a(6627),ee=a.n(Q),te=a(677),ae=a.n(te);function ne(e,t,a,n){return ae().box.open(e,t,a,n)||null}function oe(e,t,a,n=(0,V.F)(24)){return{nonce:n,sealed:ae().box(e,n,a,t)}}function re(e){return ee().convertSecretKey(e)}function se(e){return ee().convertPublicKey(e)}function ie(e,t,a){const n=(0,Z.Y)(e);return ne(n.slice(24,n.length),n.slice(0,24),se((0,Z.Y)(t)),re(a))}function ce(e,t,a,n){const{nonce:o,sealed:r}=oe((0,Z.Y)(e),re(a),se((0,Z.Y)(t)),n);return(0,q.e)(o,r)}function le(e){const t=(0,G.S)(e),a=(0,J.U)(t);return a}function ue(e){return{pair:e,address:(0,X.m)(e.publicKey,32),encodeAddress:(t=32)=>(0,X.m)(e.publicKey,t),decryptMessage:(t,a)=>ie(t,a,e.secretKey),encryptMessage:(t,a,n)=>ce(t,a,e.secretKey,n)}}var de=a(49021),pe=a(96134),me=a(57898),he=a(54129);class we extends K.Uk{constructor(e,t={},a=null){super(e,a),this.extension=null,e.loadAll(t),this.setReady(!0)}async beforeSetSender(e,{type:t,extension:a}){this.extension=a;try{this.keyring.getPair(e)}catch(n){this.keyring.loadInjected(e,{},t)}}async afterSetSender(){await super.afterSetSender(),this.account.meta.isInjected&&this.extension&&(this.api.setSigner(this.extension.signer),this.account.signMsg=async e=>(await this.extension.signer.signRaw({address:this.account.address,data:(0,pe.c)((0,me.Rl)(e)),type:"bytes"})).signature)}async addUri(e,t={},a="ed25519"){const n=this.keyring.keyring.addFromUri(e,t,a);return await this.setSender(n.address,{type:a})}async addUriPassword(e,t=void 0,a={},n="ed25519"){const{pair:o}=this.keyring.addUri(e,t,a,n);return await this.setSender(o.address,{type:n})}async addJsonPassword(e,t){const a=this.keyring.createFromJson(e);return this.keyring.addPair(a,t),await this.setSender(a.address,{type:a.type})}async addPair(e){const t=this.keyring.keyring.addFromPair(e);return await this.setSender(t.address,{type:t.type})}encryptor(e=null){if(!this.account.meta.isInjected&&"ed25519"===this.account.type){const t=this.account.toJson(e),a=(0,de.M)(e,(0,he.tV)(t.encoded),t.encoding.type);return ue(a)}}}var fe={install:async(e,t={})=>{const a=(0,c.iH)(!1),n=(0,c.XI)(),o=new we(L.ZP);e.provide("RobonomicsProvider",{isReady:a,instance:n,accountManager:o});const r=new URLSearchParams(window.location.search);let s=r.get("rpc");s||(s=localStorage.getItem("rpc-parachain")||A.default_rpc_endpoint),localStorage.setItem("rpc-parachain",s);const i={endpoint:s};n.value=await K.l.createInstance({...i,...t}),n.value.setAccountManager(o),a.value=!0}},ve=a(18414),ge=a(4812);const ye={PROVIDER:4,NETWORK:1,ACCOUNT:2};class be extends Error{constructor(e=null,...t){super(...t),this.code=e}}class ke{async activate(){}async getProvider(){}async getAccount(){}async getNetworkId(){}}class _e extends ke{constructor(e){super(),this.name="metamask",this.account=null,this.networkId=null,this.emit=e}handleAccountsChanged(e){e.length>0?this.account=e[0]:this.account=null,this.emit("accountsChanged",{account:this.account})}handleChainChanged(e){this.networkId=Number(e),this.emit("chainChanged",{networkId:this.networkId})}handleDisconnect(){this.account=null,this.emit("disconnect")}async activate(){if(!window.ethereum)throw new be(ye.PROVIDER,"Not found metamask");try{return await window.ethereum.request({method:"eth_requestAccounts"}),!0}catch(e){return!1}}async getProvider(){if(window.ethereum)return window.ethereum.autoRefreshOnNetworkChange=!1,window.ethereum.on("accountsChanged",(e=>{this.handleAccountsChanged(e)})),window.ethereum.on("chainChanged",(e=>{this.handleChainChanged(e)})),window.ethereum.on("disconnect",(()=>{this.handleDisconnect()})),window.ethereum;throw new be(ye.PROVIDER,"Not found metamask")}async getNetworkId(){return this.networkId=Number(await window.ethereum.request({method:"eth_chainId"})),this.networkId}async getAccount(){if(!window.ethereum)throw new be(ye.PROVIDER,"Not found metamask");const e=await window.ethereum.request({method:"eth_accounts"});if(e.length>0)return this.account=e[0],this.account;throw new be(ye.ACCOUNT,"You need to unblock metamask")}async isAuthorized(){if(!window.ethereum)return!1;try{const e=await window.ethereum.request({method:"eth_accounts"});return!!e.length}catch(e){return!1}}}class Se extends ke{constructor({networkId:e=1,key:t=""}){super(),this.name="infura",this.account=null,this.networkId=e,this.key=t}async activate(){throw new be(ye.PROVIDER,"Not found metamask")}async getProvider(){if(1===this.networkId)return"wss://mainnet.infura.io/ws/v3/"+this.key;if(11155111===this.networkId)return"wss://sepolia.infura.io/ws/v3/"+this.key;throw new be(ye.PROVIDER,"Bad config for infura")}async getAccount(){return null}async getNetworkId(){return this.networkId}}class Ue{constructor({networks:e=[]}={}){this.provider=null,this.connector=null,this.signer=null,this.networks=e,this.state=(0,c.qj)({isReady:!1,error:null,account:null,networkId:null,block:null})}async setConnector(e){if("metamask"===e.name){this.provider=new ve.Q(await e.getProvider());try{this.signer=await this.provider.getSigner()}catch(t){console.log(t)}}else this.provider=new ge.q(await e.getProvider());this.connector=e}on(e,t){"accountsChanged"===e?this.state.account=t.account:"chainChanged"===e&&(this.state.networkId=t.networkId),this.networks.includes(this.state.networkId)?this.state.error=null:this.state.error=new be(ye.NETWORK,`sssPlease, switch to network id ${this.networks}`)}async init(e){this.networks=e.networks;try{await this.setConnector(new _e(((e,t)=>this.on(e,t)))),await this.connector.isAuthorized()&&(this.state.account=await this.connector.getAccount())}catch(t){if(console.warn(t.message),e.infura)try{await this.setConnector(new Se(e.infura))}catch(t){this.state.error=t}}try{this.connector&&(this.state.networkId=await this.connector.getNetworkId(),this.networks.includes(this.state.networkId)||(this.state.error=new be(ye.NETWORK,`Please, switch to network id ${this.networks}`)))}catch(t){this.state.error=t}this.provider&&null===this.state.error&&(this.state.isReady=!0,this.provider.on("block",(async e=>{this.state.block=await this.provider.getBlock(e)})),this.state.block=await this.provider.getBlock("latest"))}async initAccount(){try{await this.connector.activate()&&(this.state.account=await this.connector.getAccount())}catch(e){this.state.error=e}}}const Ie=new Ue;var Ae={install:async e=>{e.provide("EthereumProvider",{web3:Ie});try{await Ie.init({networks:[11155111],infura:{networkId:11155111,key:"c1ea69ab1e0a4c6aa6a9dcd0641aecc7"}})}catch(t){console.log(t)}}};const Re=(0,s._)("b",null,"~ 2 min",-1);function Pe(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-active"),c=(0,s.up)("robo-text"),l=(0,s.up)("robo-icon"),u=(0,s.up)("robo-link"),d=(0,s.up)("robo-grid"),p=(0,s.up)("robo-details"),m=(0,s.up)("robo-grid-item"),h=(0,s.up)("robo-section"),w=(0,s.up)("robo-button"),f=(0,s.up)("robo-card"),v=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(v,{width:"middle-wide"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",minColumnWidth:"200px"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[n.rwsactive&&""!==n.rwsactive?((0,s.wg)(),(0,s.j4)(i,{key:0})):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Wm)(c,{title:"4",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)("RWS subscription")])),_:1}),(0,s.Wm)(h,{offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{size:"small",weight:"normal-italic"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",gap:"x05",columns:"1"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" Price from: "),(0,s._)("b",null,"~ "+(0,k.zw)(n.price)+" XRT ",1),(0,s.Wm)(p,null,{summary:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"circle-question"})])),default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",gap:"x05"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{weight:"bold"},{default:(0,s.w5)((()=>[(0,s.Uk)("Where to buy XRT")])),_:1}),(0,s.Wm)(u,{href:"https://app.basilisk.cloud/trade"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Basilisk ")])),_:1}),(0,s.Wm)(u,{href:"https://app.solarbeam.io/exchange/swap"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Solarbeam ")])),_:1}),(0,s.Wm)(u,{href:"https://trade.kraken.com/markets/kraken/xrt/usd"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Kraken ")])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" Activation time "),Re])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Available subscriptions: "),(0,s._)("b",null,(0,k.zw)(n.freeAuctions),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(w,{router:n.linkActivate,size:"small"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"wallet"}),(0,s.Uk)(" Buy a subscription ")])),_:1},8,["router"])],64))])),_:1})])),_:1}),(0,s.Wm)(h,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:"4",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)("What you get with RWS")])),_:1}),(0,s.Wm)(c,{size:"small",weight:"normal-italic"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",gap:"x05",columns:"1"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Brand-independent smart home ")])),_:1}),(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Secured data, only you have access ")])),_:1}),(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Remote control without corporate clouds ")])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Home assistant integration ")])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(h,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:"4",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)("What is RWS")])),_:1}),(0,s.Wm)(c,{weight:"normal-italic",size:"small",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Robonomics Web Services (RWS) is a smart home integration that enables secure interaction with smart devices and robots through transactions on the Robonomics parachain, rather than relying on centralized cloud services. ")])),_:1}),(0,s.Wm)(c,{weight:"normal-italic",size:"small",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" An RWS subscription ensures stable transaction processing with every block, making it an ideal choice for those who wish to receive data from devices and remotely manage them. ")])),_:1}),(0,s.Wm)(c,{weight:"normal-italic",size:"small",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Easy to start for Home Assistant users. "),(0,s.Wm)(u,{href:"https://wiki.robonomics.network/docs/install-smart-home/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Guide to start ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var We=a(95496),xe={setup(){const e=(0,c.iH)(0),t=(0,c.iH)(0);let a=null;const n=(0,E.oR)(),o=(0,s.Fl)((()=>n.state.robonomicsUIvue.rws.active)),r=(0,s.Fl)((()=>n.state.robonomicsUIvue.rws.links.activate)),{isReady:i,getInstance:l}=x();(0,s.YP)(i,(async n=>{if(n){const n=l();t.value=(await n.rws.getAuctionQueue()).length,a=await n.events.onBlock((async()=>{t.value=(await n.rws.getAuctionQueue()).length}));const o=await n.rws.getMinimalBid();e.value=o.add((0,We.G)(1))}}),{immediate:!0}),(0,s.Ah)((()=>{a&&a()}));const u=(0,s.Fl)((()=>i.value?h(e.value,l().api.registry.chainDecimals[0],0):0));return{rwsactive:o,linkActivate:r,freeAuctions:t,price:u}}};const Ce=(0,g.Z)(xe,[["render",Pe]]);var Oe=Ce,Ne={created:function(){window.location.href=`https://v0.dapp.robonomics.network/${this.$route.href}`}};const Ee=Ne;var Te=Ee;function De(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-buy"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{price:n.price,activationtime:"2",available:n.freeAuctions,chainInfoUploaded:n.chainInfoStatus,rwsExpiration:n.expiredate,onOnActivate:n.onActivate},null,8,["price","available","chainInfoUploaded","rwsExpiration","onOnActivate"])])),_:1})}const Me=()=>{const e=(0,c.iH)(null),{accountManager:t}=x();t.account&&(e.value=t.account.address);const a=t.onChange((t=>{e.value=t.address}));return{account:e,unsubscribe:a}},He=e=>{const t=(0,c.iH)(null),{isReady:a,getInstance:n}=x();let o;return(0,s.YP)([e,a],(async()=>{if(o&&o(),!a.value||!e.value)return;const r=n();o=await r.account.getBalance(e.value,(e=>{t.value=e.free.sub(e.frozen).toNumber()}))}),{immediate:!0}),{balance:t,unsubscribe:o}},je=()=>{const{isReady:e,getInstance:t,accountManager:a}=x(),{getFreeWeightCalc:n}=N(),o=async(e,t)=>{if(!t){if(!a.account)throw new Error("Signer required");t=a.account.address}return e.hasPaymentInfo?(await e.paymentInfo(t)).weight.toNumber():0},r=async(e,t)=>{const a=await n(t);if(a<0)throw new Error(`Not found ledger ${t}`);const r=await o(e);if(r>a)throw new Error(`The origin account have no enough free weight to process these call. Call weight ${r}, Free weight ${a}`)},s=()=>{const e=(0,c.iH)(null),t=(0,c.iH)(null),a=(0,c.iH)(!1);return{error:t,process:a,result:e}},i=async(a,n,o=!1)=>{if(a.result.value=null,a.error.value=null,a.process.value=!0,!e.value)return a.error.value="Robonomics is not ready",void(a.process.value=!1);const s=t();try{o&&(await r(n,o),s.accountManager.useSubscription(o));const e=await s.api.rpc.system.accountNextIndex(s.accountManager.account.address);a.result.value=await s.accountManager.signAndSend(n,{nonce:e}),console.log("tx",a.result.value.block,a.result.value.tx)}catch(i){console.log(i),a.error.value=i.message}return a.process.value=!1,o&&s.accountManager.useSubscription(!1),a.result};return{createTx:s,send:i}};var $e={setup(){const e=(0,c.iH)(0),t=(0,c.iH)(0),a=(0,c.iH)(!1);let n=null;const{isReady:o,getInstance:r}=x(),{account:i,unsubscribe:l}=Me(),{balance:u,unsubscribe:d}=He(i),p=N(i),m=C(i);(0,s.YP)(o,(async o=>{if(o){const o=r();t.value=(await o.rws.getAuctionQueue()).length,n=await o.events.onBlock((async()=>{t.value=(await o.rws.getAuctionQueue()).length}));const s=await o.rws.getMinimalBid();e.value=s.add((0,We.G)(1)),a.value=!0}}),{immediate:!0}),(0,s.Ah)((()=>{n&&n(),d&&d(),l()}));const w=je(),f=async a=>{if(!o.value)return void a("error","Parachain is not ready.");if(!u.value||(0,We.G)(u.value).lt(e.value.add((0,We.G)(1e7))))return void a("error","Subscription can not be activated due to unsuffcicient XRT balance");if(t.value<=0)return void a("error","There are no available subscriptions");if(p.hasSubscription.value&&p.isActive.value)return void a("error","You have an active subscription");const n=r();let c=n.rws.bid(Number(await n.rws.getFirtsFreeAuction()),e.value);m.devices.value.includes(i.value)||(c=n.api.tx.utility.batch([c,n.rws.setDevices([...m.devices.value,i.value])]));const l=w.createTx();if(await w.send(l,c),l.error.value)return void("Cancelled"!==l.error.value?a("error",l.error.value):a("cancel"));const d=await n.events.onBlock((()=>{p.loadLedger()})),h=(0,s.m0)((()=>{p.hasSubscription.value&&p.isActive.value&&(h(),d(),a("ok"))}))},v=(0,s.Fl)((()=>o.value?h(e.value,r().api.registry.chainDecimals[0],0):0));return{freeAuctions:t,price:v,expiredate:p.validUntil,chainInfoStatus:a,onActivate:f}}};const Ye=(0,g.Z)($e,[["render",De]]);var Be=Ye;function Fe(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-setup"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{onRwsUpdate:n.rwsUpdateActions,onUserDelete:n.removeUser,onUserAdd:n.addUser,onSaveHapass:n.saveHapass},null,8,["onRwsUpdate","onUserDelete","onUserAdd","onSaveHapass"])])),_:1})}var ze=a(26444),Le={setup(){const e=(0,E.oR)(),t=(0,s.Fl)((()=>e.state.robonomicsUIvue.rws.active)),{isReady:a,getInstance:n}=x(),o=je(),r=C(t),{account:i}=Me(),c=(e,t)=>{if(e.owner&&e.name&&e.controller){try{(0,X.m)(e.owner)}catch(a){return void t("error",`Owner: ${a.message}`)}try{(0,X.m)(e.controller)}catch(a){return void t("error",`Controller: ${a.message}`)}t("ok")}else t("error","All fields are required")},l=async(s,c)=>{if(!a.value)return void c("error","Parachain is not ready.");if(t.value&&t.value!==i.value)return void c("error","You do not have access to this action.");if(r.devices.value.includes(s))return void c("error","The address is already in the subscription.");const l=await n().rws.setDevices([...r.devices.value,s]),u=o.createTx();r.devices.value.includes(i.value)?await o.send(u,l,t.value):await o.send(u,l),u.error.value?"Cancelled"!==u.error.value?c("error",u.error.value):c("cancel"):(await r.loadDevices(),e.commit("rws/setUsers",r.devices),c("ok"))},u=async(s,c)=>{if(a.value)if(t.value&&t.value!==i.value)c("error","You do not have access to this action.");else{if(r.devices.value.includes(s)){const e=await n().rws.setDevices(r.devices.value.filter((e=>e!==s))),a=o.createTx();if(r.devices.value.includes(i.value)?await o.send(a,e,t.value):await o.send(a,e),a.error.value)return void("Cancelled"!==a.error.value?c("error",a.error.value):c("cancel"));await r.loadDevices()}e.commit("rws/setUsers",r.devices),c("ok")}else c("error","Parachain is not ready.")},d=async(s,i)=>{if(!a.value)return void i("error","Parachain is not ready.");const c=e.state.robonomicsUIvue.rws.user.account,l=n();await l.accountManager.addPair(e.state.robonomicsUIvue.rws.user.key);const u=l.accountManager.encryptor();try{(0,X.m)(c)}catch(g){return void i("error",g.message)}const d=r.devices.value.map((e=>(0,X.m)(e)));if(!d.includes((0,X.m)(c)))return void i("error","User not found in subscription");const p=e.state.robonomicsUIvue.rws.list.find((e=>e.owner===t.value)),m=u.encryptMessage(s,(0,ze.m)(p.controller)),h=u.encryptMessage(s,(0,ze.m)(c)),w=await l.datalog.write(JSON.stringify({subscription:p.owner,ha:p.controller,admin:(0,pe.c)(m),user:(0,pe.c)(h)})),f=o.createTx();await o.send(f,w,p.owner);const v=e.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e.state.robonomicsUIvue.polkadot.address));v&&await l.accountManager.setSender(v.address,{type:v.type,extension:e.state.robonomicsUIvue.polkadot.extensionObj}),f.error.value?"Cancelled"!==f.error.value?i("error",f.error.value):i("cancel"):i("ok")};return{saveHapass:d,rwsUpdateActions:c,addUser:l,removeUser:u}}};const Ke=(0,g.Z)(Le,[["render",Fe]]);var Ze=Ke;function qe(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-setup"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{create:"",onRwsUpdate:n.onSave},null,8,["onRwsUpdate"])])),_:1})}var Ve={setup(){let e=(e,t)=>{if(e.owner&&e.name&&e.controller){try{(0,X.m)(e.owner)}catch(a){return void t("error",`Owner: ${a.message}`)}try{(0,X.m)(e.controller)}catch(a){return void t("error",`Controller: ${a.message}`)}t("ok")}else t("error","All fields are required")};return{onSave:e}}};const Ge=(0,g.Z)(Ve,[["render",qe]]);var Je=Ge;function Xe(e,t){const a=(0,s.up)("robo-image"),n=(0,s.up)("robo-link"),o=(0,s.up)("robo-text"),r=(0,s.up)("robo-card"),i=(0,s.up)("robo-grid"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{offset:"x0",gap:"x1",galign:"start",minColumnWidth:"450px"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{router:"/telemetry"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-ha.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{router:"/telemetry"},{default:(0,s.w5)((()=>[(0,s.Uk)("Home assistant")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Integrate Robonomics into your Home assistant dashboard and get Parachain decentralized cloud service all over the word. Manipulate your smart devices bypassing corporate clouds, manage user access wherever you are. Backup your smart home data in blockchain. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://sensors.robonomics.network/#/"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-sensors.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://sensors.robonomics.network/#/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Sensors Map ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" The decentralized opensource sensors map offers two distinct layers of decentralization at your choise: peer-to-peer connectivity for direct access to sensor data, and the federative concept for accumulating sensor data and displaying measurement history. Anyone can assemble your own sensor using components available on the free market. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.spot-sdk.education"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-spot.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.spot-sdk.education"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Boston Dynamics Spot SDK lessons ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Learn and practice with the Boston Dynamics Spot robot wherever you are. After each lesson you will receive a captured video of the robot movements and a printable PDF certificate. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://telescope.merklebot.com/#/"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-telescope.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://telescope.merklebot.com/#/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" An Autonomous Telescope Minting RMRK NFT's ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Connect to an autonomous telescope in the dark night of the Atacama desert in Chile to capture an astronomical object and mint unique NFTs in a few clicks. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.ipci.io/#/offsetting"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-offsetting.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.ipci.io/#/offsetting"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Smart Building Offsetting ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Carbon footprint clearance for smart buildings based on geolocation and energy consumption information. ")])),_:1})])),_:1})])),_:1})])),_:1})}const Qe={},et=(0,g.Z)(Qe,[["render",Xe]]);var tt=et;const at=(0,s._)("h1",null,"Shop",-1);function nt(e,t,a,n,o,r){return(0,s.wg)(),(0,s.iD)("div",null,[at,(0,s._)("div",null,[(0,s._)("button",{onClick:t[0]||(t[0]=e=>n.login(!0))},"login"),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>n.addToCart&&n.addToCart(...e))},"add to cart"),(0,s._)("div",null,[(0,s._)("pre",null,(0,k.zw)(n.cart),1)]),(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>n.order&&n.order(...e))},"order"),(0,s.Uk)(" "+(0,k.zw)(n.resultOrder),1)])])}var ot={setup(){let e="";const t=(0,c.iH)({}),a=(0,c.iH)(""),n=f.Z.create({baseURL:"https://robonomics.shop/index.php"});n.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";const o=async(e={},t={})=>n.post("",t,{params:e}),r=async(t=!1)=>{if(e=localStorage.getItem("api_token_shop"),t||!e){const t=await o({route:"api/login"},{key:"Pb8XLnxqOsFQrU4zPW9FWQ9CcGpWksY66DuLL3WVIqXSpzBI8vIsVc7h294qZjyee77u2flWR2XZpgjWejKSyr10RSfBMtUW8cYzAvIgMc6q7jTlyueKsP203LHtd2W94R1YVSyqI7dLSqmrc2dP0n2ohvTwUUo4cbzMYOBtG5j7q8snVB4CFEOiUzXV28Umbqn8FkA3d3YwiCMfkZ00fpCTkDCy5u96g71bKYZk5asWvqmvPMa4w66hYn1Ow6tL"});e=t.data.api_token,console.log(e),localStorage.setItem("api_token_shop",e)}n.defaults.params={api_token:e}},s=async()=>{e||await r();const a=await o({route:"api/cart/products"});t.value=a.data};s();const i=async()=>{e||await r();const t=await o({route:"api/cart/add"},{product_id:40,quantuty:1});t.data.success&&await s()},l=async()=>{const e=await o({route:"api/shipping/methods"});console.log("shipping",e.data)},u=async()=>{const e=await o({route:"api/shipping/method"},{shipping_method:"flat.flat"});console.log("shipping",e.data)},d=async()=>{const e=await o({route:"api/shipping/address"},{firstname:"Customer",lastname:"Dear",address_1:"Somewhere",city:"KLD",country_id:"RUS",zone_id:"KGD"});console.log("shippingAddress",e.data)},p=async()=>{const e=await o({route:"api/payment/address"},{firstname:"Customer",lastname:"Dear",address_1:"Somewhere",city:"KLD",country_id:"RUS",zone_id:"KGD"});console.log("shippingAddress",e.data)},m=async()=>{const e=await o({route:"api/payment/methods"});console.log("shippingAddress",e.data)},h=async()=>{const e=await o({route:"api/payment/method"},{payment_method:"cod"});console.log("shippingAddress",e.data)},w=async()=>{const e=await o({route:"api/customer"},{firstname:"Dear",lastname:"Customer",email:"customer@example.com",telephone:"+1 879 2548022"});console.log("shippingAddress",e.data)},v=async()=>{e||await r(),await d(),await l(),await u(),await p(),await m(),await h(),await w();const t=await o({route:"api/order/add"});a.value=t.data};return{login:r,cart:t,addToCart:i,order:v,resultOrder:a}}};const rt=(0,g.Z)(ot,[["render",nt]]);var st=rt;function it(e,t,a,n,o,r){const i=(0,s.up)("Libp2p"),c=(0,s.up)("Launch");return"libp2p"===n.type?((0,s.wg)(),(0,s.j4)(i,{key:0,config:n.config,isKey:n.isKey,onConnected:n.handlerConnected,onError:n.handlerError},null,8,["config","isKey","onConnected","onError"])):((0,s.wg)(),(0,s.j4)(c,{key:1,config:n.config,isKey:n.isKey},null,8,["config","isKey"]))}function ct(e,t,a,n,o,r){const i=(0,s.up)("robo-template-devices-layout");return(0,s.wg)(),(0,s.j4)(i,{config:a.config,datalog:n.data,updateTime:n.updateTime},null,8,["config","datalog","updateTime"])}function lt(){const{account:e}=Me(),{instance:t}=(0,s.f3)("IpfsProvider");return(0,s.YP)(e,(async()=>{t.value&&t.value.authClear()})),t.value}var ut=a(82760);const dt=e=>e.replaceAll("'",'"').replaceAll("\\","").replaceAll('""','"').replaceAll("True","true").replaceAll("False","false").replaceAll("None",'"None"'),pt=e=>{try{return JSON.parse(e)}catch(t){console.log("error parse 1")}try{return JSON.parse(dt(e))}catch(t){console.log("error parse 2"),console.log(e)}return!1},mt=async(e,t)=>{const a=await e.datalog.getLastId(t);return a.id},ht=async(e,t)=>{if(console.log("getLastDatalog"),!t)return!1;const a=await mt(e,t);if(null!==a&&a>=0){const n=await e.datalog.readByIndex(t,a);return{timestamp:n[0].toNumber(),cid:(0,ut.z)(n[1])}}return!1},wt=async(e,t,a)=>{if(console.log("getConfigCid"),!t||!a&&0!==a)return!1;console.log({twin_id:a});const n=await e.twin.getTwin(a);if(!n)return!1;console.log(n);const o=Object.keys(n).find((e=>n[e]===t));return!!o&&K.P6.hexToCid(o)};var ft=a(38537),vt=a(78434);const gt=async(e,t,a)=>{if(!a)return!1;const n=await t.catViaGateways(e.state.robonomicsUIvue.ipfs.gateways,a);return e.commit("ipfs/setActiveGateway",n.gateway),n.result},yt=async(e,t,a)=>{if(e)try{const n=(0,ze.m)(t),o=a.decryptMessage((0,vt.G)(e[a.address]),n),r=ue(le((0,ut.z)(o))),s=r.decryptMessage((0,vt.G)(e.data),n);return pt((0,ut.z)(s))}catch(n){console.log(n.message)}return!1},bt=async(e,t,a,n,o)=>{if(e){const r=await gt(n,o,e);if(!r)throw console.log(`Error: ${e} not found in ipfs`),new Error(`${e} not found in ipfs`);const s=await yt(r,t,a);if(s)return s;throw console.log("Error: decryptMsg"),new Error("decryptMsg")}return null},kt=e=>{if(e.state.robonomicsUIvue.rws.active){const a=e.state.robonomicsUIvue.rws.list.find((t=>t.owner===e.state.robonomicsUIvue.rws.active));if(a)try{return{controller:a.controller,owner:a.owner}}catch(t){console.log(t)}}return!1},_t=()=>{const e=(0,c.iH)(null),t=(0,c.iH)(null),a=(0,E.oR)();return(0,s.YP)((()=>a.state.robonomicsUIvue.rws.active),(()=>{const n=kt(a);n&&(e.value=n.controller,t.value=n.owner)}),{immediate:!0}),{controller:e,owner:t}},St=(e,t,a=3e3)=>{e.dispatch("app/setStatus",{value:t,timeout:a}),console.log(t)},Ut=(e,t,a)=>{e.commit("rws/setLaunch",JSON.stringify({...t,tx:{tx_status:a}}))},It=()=>{const e=(0,c.iH)(null),t=(0,E.oR)(),a=lt(),{isReady:n,getInstance:o,accountManager:r}=x(),{controller:i}=_t(),l=async e=>{const s=localStorage.getItem("rpc-parachain")||A.default_rpc_endpoint,i=`haconfig:${s}:${e}`;if(n.value){const n=o(),s=await ht(n,e),c=await bt(s.cid,e,r.encryptor(),t,a);if(c){const o=c.twin_id;St(t,`Twin id #${o}`),St(t,"Start load config");const s=await wt(n,e,o);s||(console.log("Config not found"),console.log("controller",e),console.log("twin_id",o));const l=await bt(s,e,r.encryptor(),t,a);return localStorage.setItem(i,JSON.stringify({time:Date.now(),value:l})),console.log("getConfig chain"),{data:l,cache:!1}}}else{const e=localStorage.getItem(i);if(!e)return{data:null,cache:!0};try{const t=JSON.parse(e);return console.log("getConfig cache"),{data:t.value,cache:!0}}catch(c){console.log("haconfig bad",c)}}return{data:null,cache:!1}},u=async()=>{if(St(t,"Find twin id"),!i.value||!r.account||"ed25519"!==r.account.type)return void St(t,"Error");let a;try{a=await l(i.value)}catch(o){return console.log(o),void St(t,"Error: "+o.message)}if(e.value=a.data,a.cache){const a=(0,s.YP)(n,(async()=>{if(n.value)try{const t=await l(i.value);e.value=t.data,a()}catch(o){console.log(o),St(t,"Error: "+o.message)}}),{immediate:!0})}null!==e.value&&St(t,"Config loaded")};return{config:e,load:u}},At=()=>{const e=(0,c.iH)(null),t=(0,c.iH)(null),a=(0,c.iH)(null),n=(0,E.oR)(),o=lt(),{isReady:r,getInstance:i,accountManager:l}=x(),u=je(),d=C(),{controller:p,owner:m}=_t();let h;(0,s.YP)((()=>n.state.robonomicsUIvue.rws.active),(()=>{d.owner.value=n.state.robonomicsUIvue.rws.active}),{immediate:!0});const w=async()=>{r.value&&(h=await i().datalog.on({method:"NewRecord"},(a=>{const n=a.filter((e=>e.success&&p.value&&e.data[0].toHuman()===p.value));for(const o of n)t.value=o.data[1].toNumber(),e.value=o.data[2].toHuman()})))};(0,s.YP)(e,(async()=>{try{a.value=await bt(e.value,p.value,l.encryptor(),n,o)}catch(t){console.log(t),St(n,t.message)}}));const f=async()=>{if(p.value)if(r.value){const a=await ht(i(),p.value);e.value=a.cid,t.value=a.timestamp,w()}else{const e=(0,s.YP)(r,(t=>{t&&(f(),e())}))}},v=()=>{h&&h()};(0,s.Ah)((()=>{console.log("unmount launch"),v()}));const g=async e=>{if(console.log(e.launch.params.entity_id,e.tx.tx_status),"pending"!==e.tx.tx_status)return;if(St(n,"Launch command"),console.log(`command ${JSON.stringify(e)}`),!d.devices.value.includes(l.account.address))return St(n,"Error: You do not have access to device management."),void Ut(n,e,"error");if(!o.isAuth()){St(n,"Authorization on ipfs node");try{const e=(await l.account.signMsg((0,ft.d)(l.account.address))).toString();o.auth(m.value,l.account.address,e)}catch(w){return void("Cancelled"===w.message?Ut(n,e,"declined"):(console.log(w),Ut(n,e,"error")))}Ut(n,e,"approved")}const t=l.encryptor(),a=(0,ze.m)(p.value);let s;try{const n=JSON.stringify(e.launch),r=t.encryptMessage(n,a);s=await o.add((0,pe.c)(r))}catch(w){return Ut(n,e,"error"),void St(n,`Error: ${w.message}`)}if(console.log(`launch ipfs file ${s.path}`),!r.value)return St(n,"Error: Robonomics is not ready."),void Ut(n,e,"error");St(n,"Send launch");const c=i().launch.send(p.value,s.path),h=u.createTx();await u.send(h,c,m.value),h.error.value?"Cancelled"!==h.error.value?(Ut(n,e,"error"),St(n,`Error: ${h.error.value}`)):(Ut(n,e,"declined"),St(n,"Calcel")):(console.log(e),Ut(n,e,"success"),St(n,"Launch sended"))};return{cid:e,updateTime:t,data:a,run:f,stop:v,launch:g}};var Rt={props:{isKey:{default:!1,type:Boolean},config:{default:null,type:Object}},setup(e){const{data:t,updateTime:a,run:n,launch:o}=At(),r=(0,E.oR)();return(0,s.YP)((()=>e.isKey),(e=>{e&&n()}),{immediate:!0}),(0,s.YP)((()=>r.state.robonomicsUIvue.rws.launch),(e=>{try{o(JSON.parse(e))}catch(t){console.log(t)}})),{data:t,updateTime:a}}};const Pt=(0,g.Z)(Rt,[["render",ct]]);var Wt=Pt;function xt(e,t,a,n,o,r){const i=(0,s.up)("robo-template-devices-layout");return(0,s.wg)(),(0,s.j4)(i,{config:a.config,datalog:n.data,updateTime:n.updateTime},null,8,["config","datalog","updateTime"])}var Ct=a(71561),Ot=a(5800),Nt=a(64071),Et=a(5492),Tt=a(82373),Dt=a(10055),Mt=a(57993),Ht=a(86614),jt=a(68816),$t=a(4521),Yt=a(76046),Bt=a(92672);function Ft(){return e=>{async function t(e){return(0,$t.z)(e,(async function(e){let t="";for await(const a of e)t+=(0,Bt.B)(a.subarray());return JSON.parse(t)}))}async function a(e,t){return(0,$t.z)([(0,Yt.m)(JSON.stringify(t))],e.sink).finally((()=>{e.close()}))}return{async handle(a,n,o={runOnTransientConnection:!0}){await e.registrar.handle(a,(async({stream:e})=>{n(await t(e),e)}),o)},async request(e,t,a,n={runOnTransientConnection:!0}){if("open"!==e.status)return;const o=await e.newStream([t],n);return(0,$t.z)([(0,Yt.m)(JSON.stringify(a))],o,(async function(e){let t="";for await(const n of e)t+=(0,Bt.B)(n.subarray());try{return JSON.parse(t)}catch(a){return t}}))},utils:{getRequest:t,sendResponse:a}}}}async function zt(){const e=await(0,jt.N)({addresses:{listen:["/webrtc"]},transports:[(0,Dt.E)({filter:Mt.$6}),(0,Tt.Z)(),(0,Ot.f)()],streamMuxers:[(0,Et.R)()],connectionEncryption:[(0,Ct.t)()],services:{identify:(0,Nt.y)(),ha:Ft()},connectionGater:{denyDialMultiaddr:()=>!1},connectionManager:{minConnections:0}});return e}function Lt(e){return(0,Ht.HM)(`/dns4/libp2p-relay-1.robonomics.network/tcp/443/wss/p2p/12D3KooWEMFXXvpZUjAuj1eKR11HuzZTCQ5HmYG9MNPtsnqPSERD/p2p-circuit/p2p/${e}`)}async function Kt(e,t){if(t.length>0){const e=[],n=[];for(const a of t){const t=(0,Ht.HM)(a),o=t.protoNames();(o.includes("ws")||o.includes("wss"))&&(o.includes("p2p-circuit")?n.push(t):("https:"!==window.location.protocol||o.includes("wss"))&&e.push(t))}if(e.length>0)for(const t of e)try{return await Xt(t),t}catch(a){console.log(a)}if(n.length>0)for(const t of n)try{return await Xt(t),t}catch(a){console.log(a)}}try{const t=Lt(e);return await Xt(t),t}catch(a){console.log(a)}return!1}let Zt=null,qt=[],Vt=null;async function Gt(){if(Zt)return Zt;function e(){qt=Zt.getConnections().map((e=>e.remoteAddr.toString())),console.log("Update Connections List",qt)}return Zt=await zt(),await Zt.start(),console.log(`Node started with id ${Zt.peerId.toString()}`),Zt.addEventListener("connection:open",(t=>{console.log("connected",t.detail.remoteAddr.toString()),e()})),Zt.addEventListener("connection:close",(t=>{console.log("disconected",t.detail.remoteAddr.toString()),e(),setTimeout((()=>{Vt&&t.detail.remoteAddr.toString()===Vt.remoteAddr.toString()&&(console.log("reconnect"),Jt(Vt.remoteAddr.toString()))}),1e4)})),Zt}async function Jt(e){try{await Xt(e)}catch(t){console.log(t)}}async function Xt(e){if(console.log("connect to",e.toString()),!qt.includes(e)){const t=(0,Ht.HM)(e);Vt=await Zt.dial(t)}return e}async function Qt(){Vt&&await Vt.close(),Vt=null}function ea(e,t="/call"){if(Zt&&Vt)return Zt.services.ha.request(Vt,t,e);throw new Error("error")}const ta=()=>{const e=(0,c.iH)(null),t=(0,c.iH)(null),a=(0,E.oR)(),{accountManager:n}=x(),o=C(),{controller:r}=_t();(0,s.YP)((()=>a.state.robonomicsUIvue.rws.active),(()=>{o.owner.value=a.state.robonomicsUIvue.rws.active}),{immediate:!0}),(0,s.Ah)((()=>{Qt()}));const i=async(o,s)=>{const i=await Gt();try{St(a,`Connect to peer id ${o}`);const c=await Kt(o,s);if(c){St(a,"Connected");const o=i.getProtocols();return o.includes("/update")&&await i.unhandle("/update"),i.services.ha.handle("/update",(async(o,s)=>{const c=await yt(o.data,r.value,n.encryptor());c?(e.value=c,t.value=Date.now(),await i.services.ha.utils.sendResponse(s,{result:!0})):St(a,"Error: decryptMsg")})),c}}catch(c){St(a,`Error: ${c.message}`),console.log(c)}return!1},l=async e=>{if(console.log(e.launch.params.entity_id,e.tx.tx_status),"pending"===e.tx.tx_status){if(St(a,"Launch command"),!o.devices.value.includes(n.account.address))return St(a,"Error: You do not have access to device management."),void Ut(a,e,"error");try{const t=n.encryptor(),o=(0,ze.m)(r.value),s=JSON.stringify(e.launch),i=t.encryptMessage(s,o),c=await ea({data:{sender:n.account.address,data:(0,pe.c)(i)}});console.log("response:",c),Ut(a,e,"success")}catch(t){console.log(t),St(a,"Error: Check status of the HomeAssistant."),Ut(a,e,"error")}}};return{data:e,updateTime:t,run:i,launch:l}};var aa={props:{isKey:{default:!1,type:Boolean},config:{default:null,type:Object}},emits:["connected","error"],setup(e,{emit:t}){const{data:a,updateTime:n,run:o,launch:r}=ta(),i=(0,E.oR)(),c=e.isKey&&null!==e.config,l=(0,s.YP)((()=>[e.isKey,e.config]),(([e,a])=>{e&&null!==a&&(c||"function"!==typeof l||l(),a.peer_id?(async()=>{const e=await o(a.peer_id,a.libp2p_multiaddress);if(e)if(t("connected",e),e.protoNames().includes("p2p-circuit"))console.log("relay");else{const t=`http://${e.nodeAddress().address}:8080/ipfs/`;i.state.robonomicsUIvue.ipfs.activegateway!==t&&(console.log("set local gateway",t),i.commit("ipfs/setActiveGateway",t))}else t("error",new Error("connect"))})():t("error",new Error("not found peer_id")))}),{immediate:!0,once:c});return(0,s.YP)((()=>i.state.robonomicsUIvue.rws.launch),(e=>{try{r(JSON.parse(e))}catch(t){console.log(t)}})),{data:a,updateTime:n}}};const na=(0,g.Z)(aa,[["render",xt]]);var oa=na,ra={components:{Libp2p:oa,Launch:Wt},setup(){const e=(0,E.oR)(),{isReady:t,accountManager:a}=x(),{config:n,load:o}=It(),r=(0,c.iH)(!1),i=(0,c.iH)("libp2p");return(0,s.Ah)((async()=>{if(t.value&&r.value&&e.state.robonomicsUIvue.polkadot.address!==a.account.address){const t=e.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e.state.robonomicsUIvue.polkadot.address));t&&await a.setSender(t.address,{type:t.type,extension:e.state.robonomicsUIvue.polkadot.extensionObj})}})),(0,s.YP)((()=>e.state.robonomicsUIvue.rws.user.key),(async e=>{e?(await a.addPair(e),r.value=!0,o()):console.log("NOT KEY")}),{immediate:!0}),{type:i,isKey:r,config:n,handlerConnected:t=>{e.dispatch("app/setlibp2p",{connected:!0});let a=!1;t.protoNames().includes("p2p-circuit")&&(a=!0),e.dispatch("app/setrelay",{connected:a})},handlerError:t=>{console.log(t.message),console.log("switch to parachain"),i.value="parachain",e.dispatch("app/setlibp2p",{connected:!1}),e.dispatch("app/setrelay",{connected:!1})}}}};const sa=(0,g.Z)(ra,[["render",it]]);var ia=sa;const ca=[{path:"/",name:"Home",component:Oe,meta:{title:"Dashboard"}},{path:"/shop",name:"Shop",component:st,meta:{title:"Buy a Subscription"}},{path:"/rws-buy",name:"rwsActivate",component:Be,meta:{title:"Buy a Subscription"}},{path:"/rws-setup",name:"rwsSetup",component:Ze,meta:{title:"Setup a Subscription"}},{path:"/rws-setup-new",name:"rwsSetupNew",component:Je,meta:{title:"New Subscription setup"}},{path:"/telemetry",name:"telemetry",component:ia,meta:{title:"Devices control panel"}},{path:"/services",name:"services",component:tt,meta:{title:"Services"}},{path:"/:pathMatch(.*)*",component:Te}],la=(0,H.p7)({history:(0,H.r5)(),routes:ca});var ua=la;const da=(0,E.MT)({state:{name:"Vue"}});var pa=da,ma={install:e=>{e.config.globalProperties.$filters={balance(e,t,a){return"string"===typeof e||"number"===typeof e||"bigint"===typeof e?`${h(e,t,4)} ${a}`:""}}}};window.Buffer=n.lW,w();const ha=(0,r.ri)(Y);ha.use(ua).use(pa).use(ma).use(fe).use(Ae).use(z,{api:{gateway:"https://ipfs.url.today"},gateways:["https://ipfs.url.today/ipfs/","https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://aira.mypinata.cloud/ipfs/"]}).use(o.$,{store:pa}).mount("#app")},95856:function(){},46601:function(){},42480:function(){},63897:function(){},55024:function(){}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,n,o,r){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],r=e[u][2];for(var i=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(i=!1,r<s&&(s=r));if(i){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};a.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var r=Object.create(null);a.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&o&&n;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){s[e]=function(){return n[e]}}));return s["default"]=function(){return n},a.d(r,s),r}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,s=n[0],i=n[1],c=n[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(c)var u=c(a)}for(t&&t(n);l<s.length;l++)r=s[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},n=self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(1035)}));n=a.O(n)})();
//# sourceMappingURL=app.58477b60.js.map